

 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
    
    
    
    
    <title>Solution_of_fixing_tempdb_is_full | Mars(hnynes)</title>


    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Mars (hnynes)">
    

    
    <!--<%- open_graph({twitter_id: theme.author.twitter, google_plus: theme.author.google_plus}) %>-->

    <meta name="description" content="page.description">
    
    <meta property="og:type" content="article">
    
    <meta property="og:title" content="Solution_of_fixing_tempdb_is_full">
    <meta property="og:url" content="/mssql/2013/09/29/Solution_of_fixing_tempdb_is_full/">
    <meta property="og:site_name" content="Mars(hnynes)">
    <meta property="og:description" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Solution_of_fixing_tempdb_is_full">
    <meta name="twitter:description" content="page.description">
    <meta name="twitter:creator" content="@">
    <link rel="publisher" href="">

    
    <link rel="alternative" href="/atom.xml" title="Mars(hnynes)" type="application/atom+xml">
    
    
    

    <link rel="stylesheet" href="/assets/css/style.css" type="text/css">
    <link rel="stylesheet" href="/assets/css/highlight.css" type="text/css">
    
    <style>
        body >header {
            background: url("/assets/img/banner.jpg") center #2ca6cb;
        }
    </style>
    
    
</head>

  <body>
    <header>
        <div>
		    
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Mars(hnynes)">Mars(hnynes)</a></h1>
				<h2 class="blog-motto">Keep hungury, keep fooling.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="/search" method="get" accept-charset="utf-8">
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
					</form>
					
					</li>
				</ul>
			</nav>
</div>

    </header>
    <div id="container">
      



<div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
	<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/mssql/2013/09/29/Solution_of_fixing_tempdb_is_full/" title="Solution_of_fixing_tempdb_is_full" itemprop="url">Solution_of_fixing_tempdb_is_full</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Mars (hnynes)" target="_blank" itemprop="author">Mars (hnynes)</a>
		
  <p class="article-time">
    <time datetime="2013-09-29 00:00:00 +0800" itemprop="datePublished"> 发表于 2013-09-29</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article toc-content" style="display: none;">
		
			<!--<%- toc(item.content) %>-->
		
		</div>
		
		<p>Solution of fixing tempdb is full</p>

<p>Note that the majority of this article describes symptoms and workarounds for any database that is larger than you think it should be; it is not applicable only to tempdb.</p>

<p>SQL Server allocates a database called tempdb, primarily for worktable / #temp table usage. Sometimes, you will have one of the following symptoms: <br />
An error message in the event log:</p>

<p>Source: MSSQLSERVER <br />
Event ID: 17052 <br />
Description: The log file for database ‘tempdb’ is full. <br />
Back up the transaction log for the database to free up <br />
some log space <br />
An error message in Query Analyzer:</p>

<p>Server: Msg 8624, Level 16, State 1 <br />
Internal SQL Server error</p>

<p>or</p>

<p>Server: Msg 1101, Level 17, State 10, Line 1 <br />
Could not allocate new page for database ‘TEMPDB’. There are no more pages available in filegroup DEFAULT. Space can be created by dropping objects, adding additional files, or allowing file growth. <br />
Or you will notice that the files are much bigger than they should be – by using EXEC sp_spaceused, looking at the taskpad view in Enterprise Manager, seeing the MDF/LDF files themselves within Windows Explorer, or being alerted by monitoring software like SiteScope or Quest Spotlight.</p>

<p>Causes</p>

<p>Usually, tempdb fills up when you are low on disk space, or when you have set an unreasonably low maximum size for database growth.</p>

<p>Many people think that tempdb is only used for #temp tables. When in fact, you can easily fill up tempdb without ever creating a single temp table. Some other scenarios that can cause tempdb to fill up: <br />
any sorting that requires more memory than has been allocated to SQL Server will be forced to do its work in tempdb;</p>

<p>if the sorting requires more space than you have allocated to tempdb, one of the above errors will occur;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DBCC CheckDB('any database') will perform its work in tempdb -- on larger databases, this can consume quite a bit of space; 

DBCC DBREINDEX or similar DBCC commands with 'Sort in tempdb' option set will also potentially fill up tempdb; 
</code></pre></div></div>

<p>large resultsets involving unions, order by / group by, cartesian joins, outer joins, cursors, temp tables, table variables, and hashing can often require help from tempdb;</p>

<p>any transactions left uncommitted and not rolled back can leave objects orphaned in tempdb;</p>

<p>use of an ODBC DSN with the option ‘create temporary stored procedures’ set can leave objects there for the life of the connection.</p>

<p>Other points of analysis</p>

<p>The following will tell you how tempdb’s space is allocated:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>USE tempdb 
GO 
EXEC sp_spaceused 
The following should give you some clues as to which table(s) consume most of the space in the data file(s) -- this will help you narrow down any transactions that are either taking a long time or repeatedly being left in limbo: 
 
USE tempdb 
GO 
 
SELECT name 
    FROM tempdb..sysobjects 
 
SELECT OBJECT_NAME(id), rowcnt 
    FROM tempdb..sysindexes 
    WHERE OBJECT_NAME(id) LIKE '#%' 
    ORDER BY rowcnt DESC 
</code></pre></div></div>

<p>The higher rowcount values will likely indicate the biggest temporary tables that are consuming space. And while it won’t tell you everything, since tempdb is used for internal I/O and other processes such as sorting, it may help you narrow down the stored procedure(s) that are causing the growth (you can query INFORMATION_SCHEMA.ROUTINES for ROUTINE_DEFINITION LIKE ‘%#table_name%’ from above).</p>

<p>In addition to this, you can use Profiler to watch for events like database file auto grow and log file auto grow. If this is happening often, then you know that the space you’ve allocated to tempdb is not sufficient.</p>

<p>You can also watch performance monitor’s counter for PhysicalDisk: CurrentDiskQueueLength on the drive where tempdb exists. If this number is consistently greater than 2, then there is likely a bottleneck in disk I/O.</p>

<p>Short-term fix</p>

<p>Restarting SQL Server will re-create tempdb from scratch, and it will return to its usually allocated size. In and of itself, this solution is only effective in the very short term; assumedly, the application and/or T-SQL code which caused tempdb to grow once, will likely cause it to grow again.</p>

<p>To shrink tempdb, you can consider using DBCC ShrinkDatabase, DBCC ShrinkFile (for the data or the log file), or ALTER DATABASE. See KB #256650, KB #272318 and KB #307487 for more information.</p>

<p>If you can’t shrink the log, it might be due to an uncommitted transaction. See if you have any long-running transactions with the following command:</p>

<p>DBCC OPENTRAN – or DBCC OPENTRAN(‘tempdb’) 
Check the oldest transaction (if it returns any), and see who the SPID is (there will be a line starting with ‘SPID (Server Process ID) : ‘). Use that in the following:</p>

<p>DBCC INPUTBUFFER() 
This will tell you at least a portion of the last SQL command executed by this SPID, and will help you determine if you want to end this process with:</p>

<p>KILL</p>

<p>Long-term prevention</p>

<p>Here are some suggestions for maintaining a healthy tempdb: <br />
Make sure that tempdb is set to autogrow – do <em>NOT</em> set a maximum size for tempdb. If the current drive is too full to allow autogrow events, then buy a bigger drive, or add files to tempdb on another device (using ALTER DATABASE) and allow those files to autogrow. You will need at least one data file and at least one log file in order to avoid this problem from halting your system in the future.</p>

<p>For optimal performance, make sure that its initial size is adequate to handle a typical workload (autogrow events can cause performance to suffer as it allocates new extents). For an approach to setting a non-default size for tempdb, see the suggestion from Dinesh at http://www.tkdinesh.com/faq/ans/tempdbsh….</p>

<p>If possible, put tempdb on its own physical disk, array or disk subsystem (see KB #224071 for more information).</p>

<p>To prevent tempdb log file growth, make sure tempdb is in simple recovery mode (this allows the log to be truncated automatically). To check if this is the case:</p>

<p>– SQL Server 7.0, should show ‘trunc. log on chkpt.’ <br />
– or ‘recovery=SIMPLE’ as part of status column:</p>

<p>EXEC sp_helpdb ‘tempdb’</p>

<p>– SQL Server 2000, should yield ‘SIMPLE’:</p>

<p>SELECT DATABASEPROPERTYEX(‘tempdb’, ‘recovery’) <br />
If the database is not set to simple recovery, you can force it so as follows:</p>

<p>ALTER DATABASE tempdb SET RECOVERY SIMPLE <br />
Use SQLOLEDB, not ODBC / DSN for database access (for VB / ASP, see Article #2126 for sample connection strings).</p>

<p>Try to make sure you have covering indexes for all large table that are used in queries that can’t use a clustered index / index seek.</p>

<p>Batch larger heavily-logged operations (especially deletes) that <em>might</em> overflow into tempdb into reasonable ‘chunks’ of rows, especially when joins are involved.</p>

<p>Pore over your code for potential uncommitted transactions and other elements from the list at the top of the page.</p>

<p>In general, try to make your code as efficient as possible… avoid cursors, nested loops, and #temp tables if possible. See Article #2424 for some other general ideas on efficiency.</p>

<p>Check out the WebCast in KB #834846 for some ideas from Microsoft about administering and maintaining TempDB.<br />
Related Articles<br />
 Are there tools available for auditing changes to SQL Server data?
 Can I create an index on a BIT column?
 Can I have optional parameters to my stored procedures?
 Can I implement an input mask in SQL Server?
 Can I make SQL Server format dates and times for me?
 Can I start IDENTITY values at a new seed?
 Can SQL Server tell me which row was inserted most recently?
 How can I learn more about undocumented SQL Server stored procedures?
 How can I make my SQL queries case sensitive?
 How do I audit changes to SQL Server data?
 How do I connect to a non-default instance of SQL Server?
 How do I connect to SQL Server on a port other than 1433?
 How do I create a cross-tab (or “pivot”) query?
 How do I determine if a table exists in a SQL Server database?
 How do I drop a SQL Server database?
 How do I find all the available SQL Servers on my network?
 How do I get a list of SQL Server tables and their row counts?
 How do I get rid of Named Pipes / DBNMPNTW errors?
 How do I get the correct date/time from the msdb.sysjob* tables?
 How do I get the nth row in a SQL Server table?
 How do I get the result of dynamic SQL into a variable?
 How do I handle REPLACE() within an NTEXT column in SQL Server?
 How do I hide system tables in SQL Server’s Enterprise Manager?
 How do I know which version of SQL Server I’m running?
 How do I limit the number of rows returned in my resultset?
 How do I load text or csv file data into SQL Server?
 How do I manage changes in SQL Server objects?
 How do I monitor SQL Server performance?
 How do I prevent linked server errors?
 How do I reclaim space in SQL Server?
 How do I recover data from SQL Server’s log files?
 How do I search for special characters (e.g. %) in SQL Server?
 How do I start SQL Server Agent from ASP?
 How do I time my T-SQL code?
 How do I upsize from Access to SQL Server?
 How do I upsize my MSDE database to full-blown SQL Server 2000?
 How do I use a variable in a TOP clause in SQL Server?
 How do I use GETDATE() within a User-Defined Function (UDF)?
 How should I store an IP address in SQL Server?
 Schema: How do I find all the foreign keys in a database?
 SQL Server &amp; MSDE
 What are reserved Access, ODBC and SQL Server keywords?
 What are the capacities of Access, SQL Server, and MSDE?
 What are the main differences between Access and SQL Server?
 What do I need to know about SQL Server 2000 SP4?
 Where else can I learn about SQL Server?
 Where is SP4 for SQL Server 2000?
 Why am I having problems with SQL Server 2000 SP3 / SP3a?
 Why can’t I install SQL Server on Windows Server 2003?
 Why can’t I install SQL Server on Windows XP?
 Why can’t I use LIKE ‘%datepart%’ queries?
 Why do I get “Login failed for user ‘'.”?
 Why do I get ‘object could not be found’ or ‘invalid object name’?
 Why do I get errors about master..spt_values?
 Why do I get script errors in Enterprise Manager’s ‘taskpad’ view?
 Why do I get SQLSetConnectAttr Failed errors?
 Why do I have problems with views after altering the base table?
 Why does EM crash when I get an error in a stored procedure?
 Why does Enterprise Manager return ‘Invalid cursor state’?
 Why does my DELETE query not work?
 Why does sp_spaceused return inaccurate values?
 Why is Enterprise Manager slow at expanding my database list?
 Why is my app slow after upgrading from SQL Server 7 to 2000?
 Why should I consider using an auxiliary calendar table?
 Why should I consider using an auxiliary numbers table?</p>

<p>原文地址: http://sqlserver2000.databases.aspfaq.com/why-is-tempdb-full-and-how-can-i-prevent-this-from-happening.html</p>
  
	</div>
	<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <!--
  <%- list_categories(item.categories, {
      show_count: false,
      class: 'article-category',
      style: 'none',
      separator: '►'
  }) %>
  -->
  
  <a class="article-category-link" href="/categories/#mssql">mssql</a>
  
</div>


  <div class="article-tags">
  <!--
  <% var tags = [];
    item.tags.forEach(function(tag){
      tags.push('<a href="' + config.root + tag.path + '">' + tag.name + '</a>');
    }); %>-->
  <span></span> <!--<%- tags.join('') %>-->
  
  
  <a href="/tags/#mssql">mssql</a>
  
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://localhost:18000/mssql/2013/09/29/Solution_of_fixing_tempdb_is_full/" data-title="Solution_of_fixing_tempdb_is_full | Mars(hnynes)" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>
   
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/mssql/2013/09/24/Example_syntax_for_Secure_Copy(scp)/" title="Example_syntax_for_Secure_Copy(scp)">
  <strong>上一篇：</strong><br/>
  <span>
  Example_syntax_for_Secure_Copy(scp)</span>
</a>
</div>


<div class="next">
<a href="/linux/2013/10/14/CentOS_6.2_%E5%AE%89%E8%A3%85DNS_Server/"  title="CentOS_6.2_安装DNS_Server">
 <strong>下一篇：</strong><br/> 
 <span>CentOS_6.2_安装DNS_Server
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>


</div>  

      
      
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside toc-content">
 
 <!--<%- toc(item.content) %>-->
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/#java" title="java">java<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/#cplusplus" title="cplusplus">cplusplus<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/#windows" title="windows">windows<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/#learn" title="learn">learn<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/#mysql" title="mysql">mysql<sup>44</sup></a></li>
		  
		
		  
			<li><a href="/categories/#database" title="database">database<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/#network" title="network">network<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/#mssql" title="mssql">mssql<sup>50</sup></a></li>
		  
		
		  
			<li><a href="/categories/#项目管理" title="项目管理">项目管理<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/#test" title="test">test<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/#python" title="python">python<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/#ruby" title="ruby">ruby<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/#linux" title="linux">linux<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/#program" title="program">program<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/#oracle" title="oracle">oracle<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/#eng" title="eng">eng<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/#hadoop" title="hadoop">hadoop<sup>2</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/#java" title="java">java<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/#cplusplus" title="cplusplus">cplusplus<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/#windows" title="windows">windows<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/#learn" title="learn">learn<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/#mysql" title="mysql">mysql<sup>44</sup></a></li>
			
		
			
				<li><a href="/tags/#database" title="database">database<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/#network" title="network">network<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/#mssql" title="mssql">mssql<sup>50</sup></a></li>
			
		
			
				<li><a href="/tags/#项目管理" title="项目管理">项目管理<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/#test" title="test">test<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/#python" title="python">python<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/#ruby" title="ruby">ruby<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/#linux" title="linux">linux<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/#program" title="program">program<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/#oracle" title="oracle">oracle<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/#eng" title="eng">eng<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/#hadoop" title="hadoop">hadoop<sup>2</sup></a></li>
			
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div id="tagcloud" class="tagcloudlist clearfix">
    </div>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            <a href="https://my.oschina.net/hnyness" target="_blank" title="我的空间">我的空间</a>
          </li>
        
          <li>
            <a href="http://hnynes.blog.chinaunix.net" target="_blank" title="我的chinaunix博客">我的chinaunix博客</a>
          </li>
        
          <li>
            <a href="https://www.postgresql.org/" target="_blank" title="PostgreSQL官网">PostgreSQL官网</a>
          </li>
        
          <li>
            <a href="http://www.postgres.cn/v2/home" target="_blank" title="PostgreSQL中文社区">PostgreSQL中文社区</a>
          </li>
        
          <li>
            <a href="https://dev.mysql.com/doc/refman/5.7/en/" target="_blank" title="MySQL官文文档5.7">MySQL官文文档5.7</a>
          </li>
        
    </ul>
</div>

  


  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="hnynes" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>



</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	
	<section class="info">
		<p> Hello , I'm Mars(hnynes). <br/>
			This is my blog, believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/hnynes" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
	<!--
			<%  Array.prototype.S=String.fromCharCode(2);
			  Array.prototype.in_array=function(e){
    			var r=new RegExp(this.S+e+this.S);
    			return (r.test(this.S+this.join(this.S)+this.S));
				};
				var cc = new Array('by','by-nc','by-nc-nd','by-nc-sa','by-nd','by-sa','zero'); %>
		<% if (cc.in_array(theme.creative_commons) ) { %>
				<div class="cc-license">
          <a href="http://creativecommons.org/licenses/<%= theme.creative_commons %>/4.0" class="cc-opacity" target="_blank">
            <img src="<%- config.root %>img/cc-<%= theme.creative_commons %>.svg" alt="Creative Commons" />
          </a>
        </div>
    <% } %>
				-->

		<p class="copyright">
		Powered by <a href="http://jekyllrb.com" target="_blank" title="jekyll">jekyll</a> and Theme by <a href="https://github.com/simpleyyt/jekyll-jacman" target="_blank" title="Jacman">Jacman</a> © 2015 
		
		<a href="about" target="_blank" title="Mars (hnynes)">Mars (hnynes)</a>
		
		
		</p>
</div>
</footer>
    <script src="/assets/js/jquery-2.0.3.min.js"></script>
<script src="/assets/js/jquery.imagesloaded.min.js"></script>
<script src="/assets/js/gallery.js"></script>
<script src="/assets/js/jquery.qrcode-0.12.0.min.js"></script>
<script src="/assets/js/toc.js"></script>

<script type="text/javascript">
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });

  

  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
      
    }
  });
});
</script>


<script src="/assets/js/tagcloud.js"></script>
<script>
$(document).ready(function() {
  var tags = [
    
    { "name": "java", "path": "/tags/#java", "length": 1 },
    
    { "name": "cplusplus", "path": "/tags/#cplusplus", "length": 11 },
    
    { "name": "windows", "path": "/tags/#windows", "length": 7 },
    
    { "name": "learn", "path": "/tags/#learn", "length": 8 },
    
    { "name": "mysql", "path": "/tags/#mysql", "length": 44 },
    
    { "name": "database", "path": "/tags/#database", "length": 3 },
    
    { "name": "network", "path": "/tags/#network", "length": 1 },
    
    { "name": "mssql", "path": "/tags/#mssql", "length": 50 },
    
    { "name": "项目管理", "path": "/tags/#项目管理", "length": 1 },
    
    { "name": "test", "path": "/tags/#test", "length": 1 },
    
    { "name": "python", "path": "/tags/#python", "length": 2 },
    
    { "name": "ruby", "path": "/tags/#ruby", "length": 1 },
    
    { "name": "linux", "path": "/tags/#linux", "length": 9 },
    
    { "name": "program", "path": "/tags/#program", "length": 1 },
    
    { "name": "oracle", "path": "/tags/#oracle", "length": 2 },
    
    { "name": "eng", "path": "/tags/#eng", "length": 1 },
    
    { "name": "hadoop", "path": "/tags/#hadoop", "length": 2 },
    
  ];
  $("#tagcloud").html(tagcloudHelper(tags));
});
</script>



<script type="text/javascript">
$(document).ready(function(){
  $('#toc.toc-aside').toc({
    title: "文章目录",
    showEffect: "none"
  });
  $('#toc.toc-article').toc({
    title: "文章目录",
    showEffect: "show",
    showSpeed: 0
  });
});
</script>



<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>



<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#nothing"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
/*
  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      //$('.hoverqrcode').hide();
  });
  */
});
</script>




<script type="text/javascript">
var disqus_shortname = 'mars_tong';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<!--

-->




<link rel="stylesheet" href="/assets/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/assets/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      if ($(this).hasClass('emoji')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>


<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'G-EZGXNNMQ8Y', 'hnynes.github.io');  
ga('send', 'pageview');
</script>



<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F21dd0d415985c0109a2d87d37d7bd359' type='text/javascript'%3E%3C/script%3E"));
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/assets/img/scrollup.png"/></a>
	</div>
	<script src="/assets/js/totop.js"></script>


<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>

